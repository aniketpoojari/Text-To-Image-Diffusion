schema: '2.0'
stages:
  training:
    cmd: python src/training.py --config=params.yaml
    deps:
    - path: src/dataloader.py
      hash: md5
      md5: 5dd15a065eae81b5867a3509e8215824
      size: 2381
    - path: src/training.py
      hash: md5
      md5: 3a8ae9d99e35cc65b2e1fcd24e6fb784
      size: 12282
    params:
      params.yaml:
        DDPMScheduler.T: 300
        clip.max_length: 77
        data.raw: data/raw/flowers
        data.train_size: 10
        data.val_size: 5
        training.batch_size: 8
        training.num_epochs: 5
        training.unet_learning_rate: 0.0001
        training.vae_learning_rate: 5e-05
        training.weight_decay: 0.0001
        unet.act_fn: silu
        unet.attention_head_dim: 12
        unet.block_out_channels:
        - 64
        - 128
        - 256
        unet.cross_attention_dim: 512
        unet.down_block_types:
        - CrossAttnDownBlock2D
        - CrossAttnDownBlock2D
        - DownBlock2D
        unet.dropout: 0.1
        unet.image_size:
        - 8
        - 8
        unet.in_channels: 4
        unet.layers_per_block: 2
        unet.mid_block_type: UNetMidBlock2DCrossAttn
        unet.norm_num_groups: 32
        unet.out_channels: 4
        unet.time_embedding_type: positional
        unet.up_block_types:
        - CrossAttnUpBlock2D
        - CrossAttnUpBlock2D
        - UpBlock2D
        vae.image_size:
        - 64
        - 64
    outs:
    - path: training_completion.txt
      hash: md5
      md5: 2fd4ddf30733344266255f5faee87772
      size: 41
  log_training_model:
    cmd: python src/log_training_model.py --config=params.yaml
    deps:
    - path: src/log_training_model.py
      hash: md5
      md5: 49bee4876239c6abed3cbab587af4bd5
      size: 1564
    - path: training_completion.txt
      hash: md5
      md5: 2fd4ddf30733344266255f5faee87772
      size: 41
    params:
      params.yaml:
        mlflow_pretraining.experiment_name: Training
        mlflow_pretraining.server_uri: sqlite:///mlflow.db
    outs:
    - path: saved_models/diffuser.pth
      hash: md5
      md5: fd948f7d526f4d008754c82ed25dbffb
      size: 90785002
    - path: saved_models/vae.pth
      hash: md5
      md5: 8dc6d86891ceb7bb54aa835275f8d730
      size: 334735754
